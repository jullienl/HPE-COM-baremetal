$ ansible-playbook -i hosts_ESX ESXi70_provisioning.yml --vault-password-file ~/secrets/vault_pass.txt  --become-password-file ~/secrets/become_pass.txt 

PLAY [DNS record for the bare metal ESXi server] **************************************************************************************************************************************************************************************************************************************************************************************************

TASK [Add 'ESX-1' with '192.168.3.174' on 'dc.lj.lab' in 'lj.lab' DNS domain] *********************************************************************************************************************************************************************************************************************************************************************
changed: [ESX-1 -> dc.lj.lab]
changed: [ESX-2 -> dc.lj.lab]

PLAY [Automated ESXi 7.0 U3 installation on HPE Compute Ops Managmeent server(s) using an auto-generated ISO file with customized kickstart.] *****************************************************************************************************************************************************************************************************

TASK [Gather subset facts on localhost] ***********************************************************************************************************************************************************************************************************************************************************************************************************
ok: [ESX-1 -> localhost]
ok: [ESX-2 -> localhost]

TASK [Capture the start time (will be used later to filter COM activities and get the runtime of the playbook)] ***********************************************************************************************************************************************************************************************************************************
ok: [ESX-1]
ok: [ESX-2]

TASK [debug] **************************************************************************************************************************************************************************************************************************************************************************************************************************************
ok: [ESX-1] => {
    "start_time": "2024-01-24T15:42:10Z"
}
ok: [ESX-2] => {
    "start_time": "2024-01-24T15:42:11Z"
}

TASK [Create HPE Compute Ops Management session] **************************************************************************************************************************************************************************************************************************************************************************************************
ok: [ESX-2 -> localhost]
ok: [ESX-1 -> localhost]

TASK [Set variable access_token for the bearer token] *********************************************************************************************************************************************************************************************************************************************************************************************
ok: [ESX-1]
ok: [ESX-2]

TASK [Capture resource API versions from the COM API reference] ***********************************************************************************************************************************************************************************************************************************************************************************
ok: [ESX-1 -> localhost]
ok: [ESX-2 -> localhost]

TASK [Set a variable for the COM API reference content] *******************************************************************************************************************************************************************************************************************************************************************************************
ok: [ESX-1]
ok: [ESX-2]

TASK [Set a variable for items property of the COM API reference content] *************************************************************************************************************************************************************************************************************************************************************************
ok: [ESX-1]
ok: [ESX-2]

TASK [Set variables for each API version] *********************************************************************************************************************************************************************************************************************************************************************************************************
ok: [ESX-1] => (item=Variable set: webhooks_API_version = v1beta1)
ok: [ESX-2] => (item=Variable set: webhooks_API_version = v1beta1)
ok: [ESX-1] => (item=Variable set: user_preferences_API_version = v1beta1)
ok: [ESX-2] => (item=Variable set: user_preferences_API_version = v1beta1)
ok: [ESX-1] => (item=Variable set: servers_API_version = v1beta2)
ok: [ESX-2] => (item=Variable set: servers_API_version = v1beta2)
ok: [ESX-1] => (item=Variable set: server_settings_API_version = v1beta1)
ok: [ESX-2] => (item=Variable set: server_settings_API_version = v1beta1)
ok: [ESX-1] => (item=Variable set: schedules_API_version = v1beta2)
ok: [ESX-2] => (item=Variable set: schedules_API_version = v1beta2)
ok: [ESX-1] => (item=Variable set: reports_API_version = v1beta1)
ok: [ESX-2] => (item=Variable set: reports_API_version = v1beta1)
ok: [ESX-1] => (item=Variable set: reports_API_version = v1beta2)
ok: [ESX-2] => (item=Variable set: reports_API_version = v1beta2)
ok: [ESX-1] => (item=Variable set: metrics_configurations_API_version = v1beta1)
ok: [ESX-2] => (item=Variable set: metrics_configurations_API_version = v1beta1)
ok: [ESX-1] => (item=Variable set: jobs_API_version = v1beta2)
ok: [ESX-2] => (item=Variable set: jobs_API_version = v1beta2)
ok: [ESX-1] => (item=Variable set: jobs_API_version = v1beta3)
ok: [ESX-2] => (item=Variable set: jobs_API_version = v1beta3)
ok: [ESX-1] => (item=Variable set: job_templates_API_version = v1beta2)
ok: [ESX-2] => (item=Variable set: job_templates_API_version = v1beta2)
ok: [ESX-1] => (item=Variable set: groups_API_version = v1beta2)
ok: [ESX-2] => (item=Variable set: groups_API_version = v1beta2)
ok: [ESX-1] => (item=Variable set: firmware_bundles_API_version = v1beta2)
ok: [ESX-2] => (item=Variable set: firmware_bundles_API_version = v1beta2)
ok: [ESX-1] => (item=Variable set: filters_API_version = v1beta1)
ok: [ESX-2] => (item=Variable set: filters_API_version = v1beta1)
ok: [ESX-1] => (item=Variable set: external_services_API_version = v1beta1)
ok: [ESX-2] => (item=Variable set: external_services_API_version = v1beta1)
ok: [ESX-1] => (item=Variable set: activities_API_version = v1beta2)
ok: [ESX-2] => (item=Variable set: activities_API_version = v1beta2)

TASK [Capture all job templates] ******************************************************************************************************************************************************************************************************************************************************************************************************************
ok: [ESX-1 -> localhost]
ok: [ESX-2 -> localhost]

TASK [Set a variable for all job templates items] *************************************************************************************************************************************************************************************************************************************************************************************************
ok: [ESX-1]
ok: [ESX-2]

TASK [Set variables for each job templates] *******************************************************************************************************************************************************************************************************************************************************************************************************
ok: [ESX-1] => (item=Variable set: ApplianceReconnect_job_template_resourceUri = /compute-ops/v1beta2/job-templates/0e818877-5a9a-4ea9-8978-8391270fbaba)
ok: [ESX-1] => (item=Variable set: ApplySettingsTemplate_job_template_resourceUri = /compute-ops/v1beta2/job-templates/2d0f40f7-2a07-4c74-92e1-d1afaf49e632)
ok: [ESX-2] => (item=Variable set: ApplianceReconnect_job_template_resourceUri = /compute-ops/v1beta2/job-templates/0e818877-5a9a-4ea9-8978-8391270fbaba)
ok: [ESX-1] => (item=Variable set: ColdBoot_job_template_resourceUri = /compute-ops/v1beta2/job-templates/aacfb3e0-6575-4d4f-a711-1ee1ae768407)
ok: [ESX-2] => (item=Variable set: ApplySettingsTemplate_job_template_resourceUri = /compute-ops/v1beta2/job-templates/2d0f40f7-2a07-4c74-92e1-d1afaf49e632)
ok: [ESX-1] => (item=Variable set: CopyServerProfileTemplates_job_template_resourceUri = /compute-ops/v1beta2/job-templates/7134bdd9-dead-40e2-baef-a23b0e6c0bd5)
ok: [ESX-2] => (item=Variable set: ColdBoot_job_template_resourceUri = /compute-ops/v1beta2/job-templates/aacfb3e0-6575-4d4f-a711-1ee1ae768407)
ok: [ESX-2] => (item=Variable set: CopyServerProfileTemplates_job_template_resourceUri = /compute-ops/v1beta2/job-templates/7134bdd9-dead-40e2-baef-a23b0e6c0bd5)
ok: [ESX-1] => (item=Variable set: CreateOneviewComplianceReport_job_template_resourceUri = /compute-ops/v1beta2/job-templates/aae145a1-79a2-4516-b191-c98039c96542)
ok: [ESX-2] => (item=Variable set: CreateOneviewComplianceReport_job_template_resourceUri = /compute-ops/v1beta2/job-templates/aae145a1-79a2-4516-b191-c98039c96542)
ok: [ESX-1] => (item=Variable set: DataRoundupReportOrchestrator_job_template_resourceUri = /compute-ops/v1beta2/job-templates/b0001d36-6490-48ac-93af-a87adfb997ed)
ok: [ESX-2] => (item=Variable set: DataRoundupReportOrchestrator_job_template_resourceUri = /compute-ops/v1beta2/job-templates/b0001d36-6490-48ac-93af-a87adfb997ed)
ok: [ESX-1] => (item=Variable set: FirmwareUpdate_New_job_template_resourceUri = /compute-ops/v1beta2/job-templates/fd54a96c-cabc-42e3-aee3-374a2d009dba)
ok: [ESX-2] => (item=Variable set: FirmwareUpdate_New_job_template_resourceUri = /compute-ops/v1beta2/job-templates/fd54a96c-cabc-42e3-aee3-374a2d009dba)
ok: [ESX-1] => (item=Variable set: GetExpandedSPT_job_template_resourceUri = /compute-ops/v1beta2/job-templates/d17898e6-6907-491e-8430-7c2da795d2e5)
ok: [ESX-2] => (item=Variable set: GetExpandedSPT_job_template_resourceUri = /compute-ops/v1beta2/job-templates/d17898e6-6907-491e-8430-7c2da795d2e5)
ok: [ESX-1] => (item=Variable set: GetFullServerInventory_job_template_resourceUri = /compute-ops/v1beta2/job-templates/d6595f1b-84e6-4587-ade5-656e2a5ea20d)
ok: [ESX-2] => (item=Variable set: GetFullServerInventory_job_template_resourceUri = /compute-ops/v1beta2/job-templates/d6595f1b-84e6-4587-ade5-656e2a5ea20d)
ok: [ESX-1] => (item=Variable set: GetOneviewServerInventory_job_template_resourceUri = /compute-ops/v1beta2/job-templates/a0124cb1-00f1-46b7-818f-a9eb5f60591f)
ok: [ESX-2] => (item=Variable set: GetOneviewServerInventory_job_template_resourceUri = /compute-ops/v1beta2/job-templates/a0124cb1-00f1-46b7-818f-a9eb5f60591f)
ok: [ESX-1] => (item=Variable set: GetOneViewSettings_job_template_resourceUri = /compute-ops/v1beta2/job-templates/fc16aa48-c73c-4463-9112-e061383ebfa9)
ok: [ESX-2] => (item=Variable set: GetOneViewSettings_job_template_resourceUri = /compute-ops/v1beta2/job-templates/fc16aa48-c73c-4463-9112-e061383ebfa9)
ok: [ESX-1] => (item=Variable set: GetPowerMeterData_job_template_resourceUri = /compute-ops/v1beta2/job-templates/50fa7d05-5941-4e8e-90c3-5995f1d600a8)
ok: [ESX-2] => (item=Variable set: GetPowerMeterData_job_template_resourceUri = /compute-ops/v1beta2/job-templates/50fa7d05-5941-4e8e-90c3-5995f1d600a8)
ok: [ESX-1] => (item=Variable set: GetSettingsForTemplate_job_template_resourceUri = /compute-ops/v1beta2/job-templates/6cd671db-ce6b-45ce-894e-7b5ae23e0399)
ok: [ESX-2] => (item=Variable set: GetSettingsForTemplate_job_template_resourceUri = /compute-ops/v1beta2/job-templates/6cd671db-ce6b-45ce-894e-7b5ae23e0399)
ok: [ESX-1] => (item=Variable set: GetSSOUrl_job_template_resourceUri = /compute-ops/v1beta2/job-templates/2c7de503-77af-4340-b68d-7a26e5359b8e)
ok: [ESX-2] => (item=Variable set: GetSSOUrl_job_template_resourceUri = /compute-ops/v1beta2/job-templates/2c7de503-77af-4340-b68d-7a26e5359b8e)
ok: [ESX-1] => (item=Variable set: GroupApplyOneviewSettings_job_template_resourceUri = /compute-ops/v1beta2/job-templates/a229a162-b43f-45b0-b7bb-692df77b9746)
ok: [ESX-2] => (item=Variable set: GroupApplyOneviewSettings_job_template_resourceUri = /compute-ops/v1beta2/job-templates/a229a162-b43f-45b0-b7bb-692df77b9746)
ok: [ESX-1] => (item=Variable set: GroupApplyServerSettings_job_template_resourceUri = /compute-ops/v1beta2/job-templates/beff07ce-f36d-4699-9ac3-f872dcd63133)
ok: [ESX-2] => (item=Variable set: GroupApplyServerSettings_job_template_resourceUri = /compute-ops/v1beta2/job-templates/beff07ce-f36d-4699-9ac3-f872dcd63133)
ok: [ESX-1] => (item=Variable set: GroupCopyServerProfileTemplates_job_template_resourceUri = /compute-ops/v1beta2/job-templates/db3620d4-19a4-4b54-9804-83f8f59d48a4)
ok: [ESX-2] => (item=Variable set: GroupCopyServerProfileTemplates_job_template_resourceUri = /compute-ops/v1beta2/job-templates/db3620d4-19a4-4b54-9804-83f8f59d48a4)
ok: [ESX-1] => (item=Variable set: GroupFirmwareCompliance_job_template_resourceUri = /compute-ops/v1beta2/job-templates/23b8ba2a-6c46-4223-b028-919382c7dcac)
ok: [ESX-2] => (item=Variable set: GroupFirmwareCompliance_job_template_resourceUri = /compute-ops/v1beta2/job-templates/23b8ba2a-6c46-4223-b028-919382c7dcac)
ok: [ESX-1] => (item=Variable set: GroupFirmwareUpdate_job_template_resourceUri = /compute-ops/v1beta2/job-templates/91159b5e-9eeb-11ec-a9da-00155dc0a0c0)
ok: [ESX-2] => (item=Variable set: GroupFirmwareUpdate_job_template_resourceUri = /compute-ops/v1beta2/job-templates/91159b5e-9eeb-11ec-a9da-00155dc0a0c0)
ok: [ESX-1] => (item=Variable set: GroupGetIloSecurityParams_job_template_resourceUri = /compute-ops/v1beta2/job-templates/08be2b1b-a9b3-4abb-82a2-8048f35dbccb)
ok: [ESX-2] => (item=Variable set: GroupGetIloSecurityParams_job_template_resourceUri = /compute-ops/v1beta2/job-templates/08be2b1b-a9b3-4abb-82a2-8048f35dbccb)
ok: [ESX-1] => (item=Variable set: GroupOSInstallation_job_template_resourceUri = /compute-ops/v1beta2/job-templates/e2952628-2629-4088-93db-91742304ef0c)
ok: [ESX-2] => (item=Variable set: GroupOSInstallation_job_template_resourceUri = /compute-ops/v1beta2/job-templates/e2952628-2629-4088-93db-91742304ef0c)
ok: [ESX-1] => (item=Variable set: GroupServerInventoryReport_job_template_resourceUri = /compute-ops/v1beta2/job-templates/2dfe138a-21b7-4797-8c6b-4d8e7e5f847c)
ok: [ESX-2] => (item=Variable set: GroupServerInventoryReport_job_template_resourceUri = /compute-ops/v1beta2/job-templates/2dfe138a-21b7-4797-8c6b-4d8e7e5f847c)
ok: [ESX-1] => (item=Variable set: GroupStorageVolumeConfiguration_job_template_resourceUri = /compute-ops/v1beta2/job-templates/c708eb57-235d-4ea8-9e21-8ceea2438773)
ok: [ESX-2] => (item=Variable set: GroupStorageVolumeConfiguration_job_template_resourceUri = /compute-ops/v1beta2/job-templates/c708eb57-235d-4ea8-9e21-8ceea2438773)
ok: [ESX-1] => (item=Variable set: IloOnlyFirmwareUpdate_job_template_resourceUri = /compute-ops/v1beta2/job-templates/94caa4ef-9ff8-4805-9e97-18a09e673b66)
ok: [ESX-2] => (item=Variable set: IloOnlyFirmwareUpdate_job_template_resourceUri = /compute-ops/v1beta2/job-templates/94caa4ef-9ff8-4805-9e97-18a09e673b66)
ok: [ESX-1] => (item=Variable set: iLOSecurity_job_template_resourceUri = /compute-ops/v1beta2/job-templates/e1d69e76-38cc-4079-9192-a380baea2973)
ok: [ESX-2] => (item=Variable set: iLOSecurity_job_template_resourceUri = /compute-ops/v1beta2/job-templates/e1d69e76-38cc-4079-9192-a380baea2973)
ok: [ESX-1] => (item=Variable set: OrchestratorAddUpdateServerTemplates_job_template_resourceUri = /compute-ops/v1beta2/job-templates/abfda355-6e58-4c00-be0a-af35dbd70398)
ok: [ESX-2] => (item=Variable set: OrchestratorAddUpdateServerTemplates_job_template_resourceUri = /compute-ops/v1beta2/job-templates/abfda355-6e58-4c00-be0a-af35dbd70398)
ok: [ESX-1] => (item=Variable set: PowerOff_New_job_template_resourceUri = /compute-ops/v1beta2/job-templates/d0c13b58-748c-461f-9a61-c0c5c71f1bb4)
ok: [ESX-2] => (item=Variable set: PowerOff_New_job_template_resourceUri = /compute-ops/v1beta2/job-templates/d0c13b58-748c-461f-9a61-c0c5c71f1bb4)
ok: [ESX-1] => (item=Variable set: PowerOn_New_job_template_resourceUri = /compute-ops/v1beta2/job-templates/0cbb2377-1834-488d-840c-d5bf788c34fb)
ok: [ESX-2] => (item=Variable set: PowerOn_New_job_template_resourceUri = /compute-ops/v1beta2/job-templates/0cbb2377-1834-488d-840c-d5bf788c34fb)
ok: [ESX-1] => (item=Variable set: Restart_New_job_template_resourceUri = /compute-ops/v1beta2/job-templates/30110551-cad6-4069-95b8-dbce9bbd8525)
ok: [ESX-2] => (item=Variable set: Restart_New_job_template_resourceUri = /compute-ops/v1beta2/job-templates/30110551-cad6-4069-95b8-dbce9bbd8525)
ok: [ESX-1] => (item=Variable set: ServerNetworkConnectivity_job_template_resourceUri = /compute-ops/v1beta2/job-templates/b21ca9e2-8a1b-11ee-b9d1-0242ac120002)
ok: [ESX-2] => (item=Variable set: ServerNetworkConnectivity_job_template_resourceUri = /compute-ops/v1beta2/job-templates/b21ca9e2-8a1b-11ee-b9d1-0242ac120002)
ok: [ESX-1] => (item=Variable set: SetIloSettings_job_template_resourceUri = /compute-ops/v1beta2/job-templates/cf4f929b-d44a-4a90-93a9-820955458fd4)
ok: [ESX-2] => (item=Variable set: SetIloSettings_job_template_resourceUri = /compute-ops/v1beta2/job-templates/cf4f929b-d44a-4a90-93a9-820955458fd4)
ok: [ESX-1] => (item=Variable set: SppUpdate_job_template_resourceUri = /compute-ops/v1beta2/job-templates/2626e682-7bd4-40e3-b93a-745133deecd2)
ok: [ESX-2] => (item=Variable set: SppUpdate_job_template_resourceUri = /compute-ops/v1beta2/job-templates/2626e682-7bd4-40e3-b93a-745133deecd2)

TASK [Capture server 'CZ2311004H' information] ****************************************************************************************************************************************************************************************************************************************************************************************************
ok: [ESX-1 -> localhost]
ok: [ESX-2 -> localhost]

TASK [Exit if server 'CZ2311004H' does not exist] *************************************************************************************************************************************************************************************************************************************************************************************************
skipping: [ESX-1]
skipping: [ESX-2]

TASK [Capture server 'CZ2311004H' generation, id, uri, connection status and iLO IP] **************************************************************************************************************************************************************************************************************************************************************
ok: [ESX-1]
ok: [ESX-2]

TASK [debug] **************************************************************************************************************************************************************************************************************************************************************************************************************************************
ok: [ESX-1] => {
    "msg": [
        "Generation: GEN_10",
        "ID: P28948-B21+CZ2311004H",
        "URI: /compute-ops/v1beta2/servers/P28948-B21+CZ2311004H",
        "Connection status: True",
        "iLO IP: 192.168.0.21"
    ]
}
ok: [ESX-2] => {
    "msg": [
        "Generation: GEN_10",
        "ID: P28948-B21+CZ2311004G",
        "URI: /compute-ops/v1beta2/servers/P28948-B21+CZ2311004G",
        "Connection status: True",
        "iLO IP: 192.168.0.20"
    ]
}

TASK [Exit if server 'CZ2311004H' is not connected to COM] ****************************************************************************************************************************************************************************************************************************************************************************************
skipping: [ESX-1]
skipping: [ESX-2]

TASK [Wait until the server 'CZ2311004H' raw inventory information is available (necessary when the server has recently been added to COM) then capture the data] *********************************************************************************************************************************************************************************
ok: [ESX-2 -> localhost]
ok: [ESX-1 -> localhost]

TASK [Wait until the complete discovery of server 'CZ2311004H' is complete (necessary when the server has recently been added to COM).] ***********************************************************************************************************************************************************************************************************
ok: [ESX-1 -> localhost]
ok: [ESX-2 -> localhost]

TASK [Check if workload profile 'Virtualization - Power Efficient' exists] ************************************************************************************************************************************************************************************************************************************************************************
ok: [ESX-1 -> localhost]
ok: [ESX-2 -> localhost]

TASK [Exit if workload profile 'Virtualization - Power Efficient' does not exist] *****************************************************************************************************************************************************************************************************************************************************************
skipping: [ESX-1]
skipping: [ESX-2]

TASK [Set a variable for the resourceUri of workload profile 'Virtualization - Power Efficient'] **************************************************************************************************************************************************************************************************************************************************
ok: [ESX-1]
ok: [ESX-2]

TASK [Wait until PCI devices information is available then capture the server 'CZ2311004H' raw inventory information] *****************************************************************************************************************************************************************************************************************************
ok: [ESX-1 -> localhost]
ok: [ESX-2 -> localhost]

TASK [Capture the presence of a NS204i NVMe boot controller in server 'CZ2311004H'] ***************************************************************************************************************************************************************************************************************************************************************
ok: [ESX-1] => (item=never)
skipping: [ESX-1] => (item=never) 
skipping: [ESX-2] => (item=never) 
skipping: [ESX-2]

TASK [debug] **************************************************************************************************************************************************************************************************************************************************************************************************************************************
ok: [ESX-1] => {
    "msg": "NS204i found in server 'CZ2311004H'! NVMe RAID1 volume will be used as the target volume for the installation of ESXi!"
}
skipping: [ESX-2]

TASK [debug] **************************************************************************************************************************************************************************************************************************************************************************************************************************************
skipping: [ESX-1]
ok: [ESX-2] => {
    "msg": "No NS204i found in server 'CZ2311004G'! Let's check if a storage controller with drives is available..."
}

TASK [Capture size of the NS204i RAID1 volume if any] *********************************************************************************************************************************************************************************************************************************************************************************************
ok: [ESX-1] => (item=never)
skipping: [ESX-1] => (item=never) 
skipping: [ESX-2] => (item=never) 
skipping: [ESX-2]

TASK [debug] **************************************************************************************************************************************************************************************************************************************************************************************************************************************
ok: [ESX-1] => {
    "msg": "Size of NS204i volume: 447.1 GB"
}
skipping: [ESX-2]

TASK [Capture storage RAID controller information when an HPE MR or SR controller is used with available drives] **********************************************************************************************************************************************************************************************************************************
skipping: [ESX-1] => (item=never) 
skipping: [ESX-1] => (item=never) 
skipping: [ESX-1]
ok: [ESX-2] => (item=never)

TASK [Set a variable for the name of the storage RAID controller found] ***************************************************************************************************************************************************************************************************************************************************************************
skipping: [ESX-1]
ok: [ESX-2]

TASK [debug] **************************************************************************************************************************************************************************************************************************************************************************************************************************************
skipping: [ESX-1]
ok: [ESX-2] => {
    "msg": "Storage RAID controller found: 'HPE MR416i-a Gen10+' with '4' drives"
}

TASK [Exit when no NS204i and no SR/MR controller is found] ***************************************************************************************************************************************************************************************************************************************************************************************
skipping: [ESX-1]
skipping: [ESX-2]

TASK [Set a controller type variable for kickstart creation when a NS204i is present] *************************************************************************************************************************************************************************************************************************************************************
ok: [ESX-1]
skipping: [ESX-2]

TASK [Set a controller type variable for kickstart creation when there is no NS204i but an SR/MR controller is present.] **************************************************************************************************************************************************************************************************************************
skipping: [ESX-1]
ok: [ESX-2]

TASK [debug] **************************************************************************************************************************************************************************************************************************************************************************************************************************************
ok: [ESX-1] => {
    "msg": "Controller type found that will be used by autounattend.xml: NS204i"
}
ok: [ESX-2] => {
    "msg": "Controller type found that will be used by autounattend.xml: HPE MR416i-a Gen10+"
}

TASK [Check if server settings 'RAID1' already exist] *********************************************************************************************************************************************************************************************************************************************************************************************
skipping: [ESX-1]
ok: [ESX-2 -> localhost]

TASK [Create internal storage configuration using 'RAID1' with a volume size of '-1' GB for the OS boot volume when it does not exist] ************************************************************************************************************************************************************************************************************
skipping: [ESX-1]
skipping: [ESX-2]

TASK [Result of the 'RAID1' creation task] ********************************************************************************************************************************************************************************************************************************************************************************************************
skipping: [ESX-1]
skipping: [ESX-2]

TASK [Set a variable for the resourceUri of the internal storage configuration 'RAID1' just created] **********************************************************************************************************************************************************************************************************************************************
skipping: [ESX-1]
skipping: [ESX-2]

TASK [Update internal storage configuration using 'RAID1' with a volume size of '-1' GB for the OS boot volume] ***********************************************************************************************************************************************************************************************************************************
skipping: [ESX-1]
ok: [ESX-2 -> localhost]

TASK [Result of the 'RAID1' update task] **********************************************************************************************************************************************************************************************************************************************************************************************************
skipping: [ESX-1]
ok: [ESX-2] => {
    "internal_storage_server_setting_result.msg": "OK (462 bytes)"
}

TASK [Set a variable for the resourceUri of the internal storage configuration 'RAID1' just updated] **********************************************************************************************************************************************************************************************************************************************
skipping: [ESX-1]
ok: [ESX-2]

TASK [debug] **************************************************************************************************************************************************************************************************************************************************************************************************************************************
skipping: [ESX-1]
ok: [ESX-2] => {
    "internal_storage_server_setting_resourceuri": "/compute-ops/v1beta1/server-settings/378bd822-db05-419b-abd2-e63ce2ad10bf"
}

TASK [Create server group name 'ESX-1_server_group' variable] *************************************************************************************************************************************************************************************************************************************************************************************
ok: [ESX-1]
ok: [ESX-2]

TASK [Check if group 'ESX-1_server_group' already exists] *****************************************************************************************************************************************************************************************************************************************************************************************
ok: [ESX-1 -> localhost]
ok: [ESX-2 -> localhost]

TASK [Create temporary group 'ESX-1_server_group' with no local storage configuration definition (if it does not exist)] **************************************************************************************************************************************************************************************************************************
skipping: [ESX-2]
ok: [ESX-1 -> localhost]

TASK [Display response of the temporary group 'ESX-1_server_group' creation request] **************************************************************************************************************************************************************************************************************************************************************
ok: [ESX-1] => {
    "server_group_result.msg": "OK (1038 bytes)"
}
skipping: [ESX-2]

TASK [Set variables for the id and the resourceUri of temporary group 'ESX-1_server_group' just created] ******************************************************************************************************************************************************************************************************************************************
ok: [ESX-1]
skipping: [ESX-2]

TASK [Update temporary group 'ESX-1_server_group' with no local storage configuration definition (if it does exist)] ******************************************************************************************************************************************************************************************************************************
skipping: [ESX-1]
skipping: [ESX-2]

TASK [Display response of the temporary group 'ESX-1_server_group' update request] ****************************************************************************************************************************************************************************************************************************************************************
skipping: [ESX-1]
skipping: [ESX-2]

TASK [Set variables for the id and the resourceUri of temporary group 'ESX-1_server_group' just updated] ******************************************************************************************************************************************************************************************************************************************
skipping: [ESX-1]
skipping: [ESX-2]

TASK [Create temporary group 'ESX-1_server_group' with local storage configuration definition (if it does not exist)] *****************************************************************************************************************************************************************************************************************************
skipping: [ESX-1]
ok: [ESX-2 -> localhost]

TASK [Display response of the temporary group 'ESX-1_server_group' creation request] **************************************************************************************************************************************************************************************************************************************************************
skipping: [ESX-1]
ok: [ESX-2] => {
    "server_group_result.msg": "OK (1126 bytes)"
}

TASK [Set variables for the id and the resourceUri of temporary group 'ESX-1_server_group' just created] ******************************************************************************************************************************************************************************************************************************************
skipping: [ESX-1]
ok: [ESX-2]

TASK [Update temporary group 'ESX-1_server_group' with local storage configuration definition (if it does exist)] *********************************************************************************************************************************************************************************************************************************
skipping: [ESX-1]
skipping: [ESX-2]

TASK [Display response of the temporary group 'ESX-1_server_group' update request] ****************************************************************************************************************************************************************************************************************************************************************
skipping: [ESX-1]
skipping: [ESX-2]

TASK [Set variables for the id and the resourceUri of temporary group 'ESX-1_server_group' just updated] ******************************************************************************************************************************************************************************************************************************************
skipping: [ESX-1]
skipping: [ESX-2]

TASK [debug] **************************************************************************************************************************************************************************************************************************************************************************************************************************************
ok: [ESX-1] => {
    "temporary_group_id": "0da237a6-2fed-4c25-a6ec-4737fbdee0bf"
}
ok: [ESX-2] => {
    "temporary_group_id": "cc61523a-e0a4-471f-ab24-dee6694237fd"
}

TASK [debug] **************************************************************************************************************************************************************************************************************************************************************************************************************************************
ok: [ESX-1] => {
    "temporary_group_resourceuri": "/compute-ops/v1beta2/groups/0da237a6-2fed-4c25-a6ec-4737fbdee0bf"
}
ok: [ESX-2] => {
    "temporary_group_resourceuri": "/compute-ops/v1beta2/groups/cc61523a-e0a4-471f-ab24-dee6694237fd"
}

TASK [Check if server 'CZ2311004H' is already member of a server group] ***************************************************************************************************************************************************************************************************************************************************************************
ok: [ESX-1 -> localhost]
ok: [ESX-2 -> localhost]

TASK [debug] **************************************************************************************************************************************************************************************************************************************************************************************************************************************
ok: [ESX-1] => {
    "server_info_from_ui_doorway.json.group_": ""
}
ok: [ESX-2] => {
    "server_info_from_ui_doorway.json.group_": ""
}

TASK [Capture the id of the server group of which the server 'CZ2311004H' is a member (if applicable)] ********************************************************************************************************************************************************************************************************************************************
skipping: [ESX-1]
skipping: [ESX-2]

TASK [debug] **************************************************************************************************************************************************************************************************************************************************************************************************************************************
skipping: [ESX-1]
skipping: [ESX-2]

TASK [Remove server 'CZ2311004H' from the server group of which it is currently a member] *********************************************************************************************************************************************************************************************************************************************************
skipping: [ESX-1]
skipping: [ESX-2]

TASK [Wait for deletion to complete] **************************************************************************************************************************************************************************************************************************************************************************************************************
skipping: [ESX-1]

TASK [Assign server 'CZ2311004H' to temporary group 'ESX-1_server_group'] *************************************************************************************************************************************************************************************************************************************************************************
ok: [ESX-2 -> localhost]
ok: [ESX-1 -> localhost]

TASK [Display response of the group assignment task] **********************************************************************************************************************************************************************************************************************************************************************************************
ok: [ESX-1] => {
    "group_assignment_result.msg": "OK (518 bytes)"
}
ok: [ESX-2] => {
    "group_assignment_result.msg": "OK (518 bytes)"
}

TASK [Wait for the configuration of server 'CZ2311004H' to complete] ******************************************************************************************************************************************************************************************************************************************************************************
FAILED - RETRYING: [ESX-1 -> localhost]: Wait for the configuration of server 'CZ2311004H' to complete (30 retries left).
FAILED - RETRYING: [ESX-2 -> localhost]: Wait for the configuration of server 'CZ2311004G' to complete (30 retries left).
FAILED - RETRYING: [ESX-2 -> localhost]: Wait for the configuration of server 'CZ2311004G' to complete (29 retries left).
ok: [ESX-1 -> localhost]
FAILED - RETRYING: [ESX-2 -> localhost]: Wait for the configuration of server 'CZ2311004G' to complete (28 retries left).
FAILED - RETRYING: [ESX-2 -> localhost]: Wait for the configuration of server 'CZ2311004G' to complete (27 retries left).
FAILED - RETRYING: [ESX-2 -> localhost]: Wait for the configuration of server 'CZ2311004G' to complete (26 retries left).
FAILED - RETRYING: [ESX-2 -> localhost]: Wait for the configuration of server 'CZ2311004G' to complete (25 retries left).
FAILED - RETRYING: [ESX-2 -> localhost]: Wait for the configuration of server 'CZ2311004G' to complete (24 retries left).
FAILED - RETRYING: [ESX-2 -> localhost]: Wait for the configuration of server 'CZ2311004G' to complete (23 retries left).
FAILED - RETRYING: [ESX-2 -> localhost]: Wait for the configuration of server 'CZ2311004G' to complete (22 retries left).
ok: [ESX-2 -> localhost]

TASK [Exit if configuration of server 'CZ2311004H' failed to complete] ****************************************************************************************************************************************************************************************************************************************************************************
skipping: [ESX-1]
skipping: [ESX-2]

TASK [Capture server 'CZ2311004H' raw inventory information] **************************************************************************************************************************************************************************************************************************************************************************************
skipping: [ESX-1]
ok: [ESX-2 -> localhost]

TASK [Capture storage RAID controller information when an HPE MR or SR controller is used with available drives] **********************************************************************************************************************************************************************************************************************************
skipping: [ESX-1]
ok: [ESX-2] => (item=never)

TASK [Capture the size of the OS volume configured on the {{ storage_controller_name }}] **********************************************************************************************************************************************************************************************************************************************************
skipping: [ESX-1]
ok: [ESX-2]

TASK [debug] **************************************************************************************************************************************************************************************************************************************************************************************************************************************
ok: [ESX-1] => {
    "boot_drive_bytes_size": "480036519936"
}
ok: [ESX-2] => {
    "boot_drive_bytes_size": "599584145408"
}

TASK [debug] **************************************************************************************************************************************************************************************************************************************************************************************************************************************
skipping: [ESX-1]
ok: [ESX-2] => {
    "msg": "Size of RAID volume: 558.4 GB"
}

TASK [Check if HPE ESXi Custom ISO file 'VMware-ESXi-7.0.3-21930508-HPE-703.0.0.11.4.0.5-Sep2023.iso' exists in '/home/labrat/ISOs/esxiisosrc' on 'ansible.lj.lab'] *******************************************************************************************************************************************************************************
ok: [ESX-1 -> localhost]
ok: [ESX-2 -> localhost]

TASK [Create the directory '/home/labrat/ISOs/esxiisosrc' to host the ISO file on 'ansible.lj.lab'] ***********************************************************************************************************************************************************************************************************************************************
skipping: [ESX-1]
skipping: [ESX-2]

TASK [Check if ESXi ISO 'https://liogw.lj.lab/deployment/esxi70u3/VMware-ESXi-7.0.3-21930508-HPE-703.0.0.11.4.0.5-Sep2023.iso' exists] ************************************************************************************************************************************************************************************************************
skipping: [ESX-1]
skipping: [ESX-2]

TASK [Download file 'VMware-ESXi-7.0.3-21930508-HPE-703.0.0.11.4.0.5-Sep2023.iso' to 'ansible.lj.lab' in '/home/labrat/ISOs/esxiisosrc' if not present] *******************************************************************************************************************************************************************************************
skipping: [ESX-1]
skipping: [ESX-2]

TASK [Create '/mnt/ESX-1' on 'ansible.lj.lab' if it does not exist] *******************************************************************************************************************************************************************************************************************************************************************************
changed: [ESX-1 -> localhost]
changed: [ESX-2 -> localhost]

TASK [Create '/home/labrat/staging/baremetal/ESX-1/' on 'ansible.lj.lab' if it does not exist] ****************************************************************************************************************************************************************************************************************************************************
changed: [ESX-1 -> localhost]
changed: [ESX-2 -> localhost]

TASK [Mount ESXi ISO '/home/labrat/ISOs/esxiisosrc/VMware-ESXi-7.0.3-21930508-HPE-703.0.0.11.4.0.5-Sep2023.iso' to '/mnt/ESX-1/'] *****************************************************************************************************************************************************************************************************************
changed: [ESX-1 -> localhost]
changed: [ESX-2 -> localhost]

TASK [Copy ISO files to '/home/labrat/staging/baremetal/ESX-1/' on 'ansible.lj.lab'] **************************************************************************************************************************************************************************************************************************************************************
changed: [ESX-1 -> localhost]
changed: [ESX-2 -> localhost]

TASK [Set permissions to allow the user running the Ansible playbook to delete the folder '/home/labrat/staging/baremetal/ESX-1'] *****************************************************************************************************************************************************************************************************************
changed: [ESX-1 -> localhost]
changed: [ESX-2 -> localhost]

TASK [Unmount directory '/mnt/ESX-1'] *************************************************************************************************************************************************************************************************************************************************************************************************************
changed: [ESX-1 -> localhost]
changed: [ESX-2 -> localhost]

TASK [Modify UEFI bootloader for kickstart installation from CDROM] *******************************************************************************************************************************************************************************************************************************************************************************
changed: [ESX-1 -> localhost]
changed: [ESX-2 -> localhost]

TASK [Create kickstart file in '/home/labrat/staging/baremetal/ESX-1/' on 'ansible.lj.lab' with variable substitution] ****************************************************************************************************************************************************************************************************************************
changed: [ESX-1 -> localhost]
changed: [ESX-2 -> localhost]

TASK [Create customized bootable ISO in '/home/labrat/staging/baremetal/ESX-1/'] ******************************************************************************************************************************************************************************************************************************************************************
changed: [ESX-1 -> localhost]
changed: [ESX-2 -> localhost]

TASK [Create '/usr/share/nginx/html/isos/' on 'ansible.lj.lab' if it does not exist] **************************************************************************************************************************************************************************************************************************************************************
ok: [ESX-2 -> localhost]
ok: [ESX-1 -> localhost]

TASK [Move created ISO to the nginx default html folder. ISO URL='http://ansible.lj.lab/isos/ESX-1.iso'] ******************************************************************************************************************************************************************************************************************************************
changed: [ESX-1 -> localhost]
changed: [ESX-2 -> localhost]

TASK [Update SELinux security contexts so that Nginx is allowed to serve content from the '/usr/share/nginx/html/isos/' directory.] ***************************************************************************************************************************************************************************************************************
changed: [ESX-2 -> localhost]
changed: [ESX-1 -> localhost]

TASK [Check if the operating system image server setting 'OS_Image_ESXi7.0.u3_for_ESX-1' exists] **************************************************************************************************************************************************************************************************************************************************
ok: [ESX-1 -> localhost]
ok: [ESX-2 -> localhost]

TASK [Create an operating system image server setting 'OS_Image_ESXi7.0.u3_for_ESX-1' if it does not exist] ***************************************************************************************************************************************************************************************************************************************
ok: [ESX-1 -> localhost]
ok: [ESX-2 -> localhost]

TASK [Result of the 'OS_Image_ESXi7.0.u3_for_ESX-1' creation task] ********************************************************************************************************************************************************************************************************************************************************************************
ok: [ESX-1] => {
    "OS_image_server_setting_result.msg": "OK (473 bytes)"
}
ok: [ESX-2] => {
    "OS_image_server_setting_result.msg": "OK (473 bytes)"
}

TASK [Set variables for the id and the resourceUri of the OS Image configuration 'OS_Image_ESXi7.0.u3_for_ESX-1' just created] ********************************************************************************************************************************************************************************************************************
ok: [ESX-1]
ok: [ESX-2]

TASK [Update the operating system image server setting 'OS_Image_ESXi7.0.u3_for_ESX-1' if it does not exist] **************************************************************************************************************************************************************************************************************************************
skipping: [ESX-1]
skipping: [ESX-2]

TASK [Result of the 'OS_Image_ESXi7.0.u3_for_ESX-1' update task] **********************************************************************************************************************************************************************************************************************************************************************************
skipping: [ESX-1]
skipping: [ESX-2]

TASK [Set variables for the id and the resourceUri of the OS Image configuration 'OS_Image_ESXi7.0.u3_for_ESX-1' just updated] ********************************************************************************************************************************************************************************************************************
skipping: [ESX-1]
skipping: [ESX-2]

TASK [debug] **************************************************************************************************************************************************************************************************************************************************************************************************************************************
ok: [ESX-1] => {
    "OS_image_server_setting_resourceuri": "/compute-ops/v1beta1/server-settings/f596e5f5-dea1-4517-ae51-34d0533596fb"
}
ok: [ESX-2] => {
    "OS_image_server_setting_resourceuri": "/compute-ops/v1beta1/server-settings/e6ac9b51-ac8a-4525-a353-00d36615d2b3"
}

TASK [debug] **************************************************************************************************************************************************************************************************************************************************************************************************************************************
ok: [ESX-1] => {
    "OS_image_server_setting_id": "f596e5f5-dea1-4517-ae51-34d0533596fb"
}
ok: [ESX-2] => {
    "OS_image_server_setting_id": "e6ac9b51-ac8a-4525-a353-00d36615d2b3"
}

TASK [Update temporary group 'ESX-1_server_group' to add OS image installation settings with NS204i] **********************************************************************************************************************************************************************************************************************************************
skipping: [ESX-2]
ok: [ESX-1 -> localhost]

TASK [Display response of the group 'ESX-1_server_group' update request with NS204i] **************************************************************************************************************************************************************************************************************************************************************
ok: [ESX-1] => {
    "server_group_result.msg": "OK (1617 bytes)"
}
skipping: [ESX-2]

TASK [Update temporary group 'ESX-1_server_group' to add OS image installation settings with storage controller (without NS204i)] *****************************************************************************************************************************************************************************************************************
skipping: [ESX-1]
ok: [ESX-2 -> localhost]

TASK [Display response of the group 'ESX-1_server_group' update request with storage controller] **************************************************************************************************************************************************************************************************************************************************
skipping: [ESX-1]
ok: [ESX-2] => {
    "server_group_result.msg": "OK (1705 bytes)"
}

TASK [Start OS image installation in group 'ESX-1_server_group'] **********************************************************************************************************************************************************************************************************************************************************************************
ok: [ESX-1 -> localhost]
ok: [ESX-2 -> localhost]

TASK [Display response of the OS image installation request in group 'ESX-1_server_group'] ********************************************************************************************************************************************************************************************************************************************************
ok: [ESX-1] => {
    "group_os_installation_result.msg": "OK (958 bytes)"
}
ok: [ESX-2] => {
    "group_os_installation_result.msg": "OK (958 bytes)"
}

TASK [Wait for the OS image installation of server 'CZ2311004H' to complete] **********************************************************************************************************************************************************************************************************************************************************************
FAILED - RETRYING: [ESX-1 -> localhost]: Wait for the OS image installation of server 'CZ2311004H' to complete (60 retries left).
FAILED - RETRYING: [ESX-2 -> localhost]: Wait for the OS image installation of server 'CZ2311004G' to complete (60 retries left).
FAILED - RETRYING: [ESX-1 -> localhost]: Wait for the OS image installation of server 'CZ2311004H' to complete (59 retries left).
FAILED - RETRYING: [ESX-2 -> localhost]: Wait for the OS image installation of server 'CZ2311004G' to complete (59 retries left).
FAILED - RETRYING: [ESX-1 -> localhost]: Wait for the OS image installation of server 'CZ2311004H' to complete (58 retries left).
FAILED - RETRYING: [ESX-2 -> localhost]: Wait for the OS image installation of server 'CZ2311004G' to complete (58 retries left).
FAILED - RETRYING: [ESX-1 -> localhost]: Wait for the OS image installation of server 'CZ2311004H' to complete (57 retries left).
FAILED - RETRYING: [ESX-2 -> localhost]: Wait for the OS image installation of server 'CZ2311004G' to complete (57 retries left).
FAILED - RETRYING: [ESX-1 -> localhost]: Wait for the OS image installation of server 'CZ2311004H' to complete (56 retries left).
FAILED - RETRYING: [ESX-2 -> localhost]: Wait for the OS image installation of server 'CZ2311004G' to complete (56 retries left).
FAILED - RETRYING: [ESX-1 -> localhost]: Wait for the OS image installation of server 'CZ2311004H' to complete (55 retries left).
FAILED - RETRYING: [ESX-2 -> localhost]: Wait for the OS image installation of server 'CZ2311004G' to complete (55 retries left).
FAILED - RETRYING: [ESX-1 -> localhost]: Wait for the OS image installation of server 'CZ2311004H' to complete (54 retries left).
FAILED - RETRYING: [ESX-2 -> localhost]: Wait for the OS image installation of server 'CZ2311004G' to complete (54 retries left).
FAILED - RETRYING: [ESX-2 -> localhost]: Wait for the OS image installation of server 'CZ2311004G' to complete (53 retries left).
FAILED - RETRYING: [ESX-1 -> localhost]: Wait for the OS image installation of server 'CZ2311004H' to complete (53 retries left).
FAILED - RETRYING: [ESX-1 -> localhost]: Wait for the OS image installation of server 'CZ2311004H' to complete (52 retries left).
FAILED - RETRYING: [ESX-2 -> localhost]: Wait for the OS image installation of server 'CZ2311004G' to complete (52 retries left).
FAILED - RETRYING: [ESX-1 -> localhost]: Wait for the OS image installation of server 'CZ2311004H' to complete (51 retries left).
FAILED - RETRYING: [ESX-2 -> localhost]: Wait for the OS image installation of server 'CZ2311004G' to complete (51 retries left).
FAILED - RETRYING: [ESX-1 -> localhost]: Wait for the OS image installation of server 'CZ2311004H' to complete (50 retries left).
FAILED - RETRYING: [ESX-2 -> localhost]: Wait for the OS image installation of server 'CZ2311004G' to complete (50 retries left).
FAILED - RETRYING: [ESX-1 -> localhost]: Wait for the OS image installation of server 'CZ2311004H' to complete (49 retries left).
FAILED - RETRYING: [ESX-2 -> localhost]: Wait for the OS image installation of server 'CZ2311004G' to complete (49 retries left).
FAILED - RETRYING: [ESX-1 -> localhost]: Wait for the OS image installation of server 'CZ2311004H' to complete (48 retries left).
FAILED - RETRYING: [ESX-2 -> localhost]: Wait for the OS image installation of server 'CZ2311004G' to complete (48 retries left).
FAILED - RETRYING: [ESX-1 -> localhost]: Wait for the OS image installation of server 'CZ2311004H' to complete (47 retries left).
FAILED - RETRYING: [ESX-2 -> localhost]: Wait for the OS image installation of server 'CZ2311004G' to complete (47 retries left).
FAILED - RETRYING: [ESX-1 -> localhost]: Wait for the OS image installation of server 'CZ2311004H' to complete (46 retries left).
FAILED - RETRYING: [ESX-2 -> localhost]: Wait for the OS image installation of server 'CZ2311004G' to complete (46 retries left).
FAILED - RETRYING: [ESX-1 -> localhost]: Wait for the OS image installation of server 'CZ2311004H' to complete (45 retries left).
FAILED - RETRYING: [ESX-2 -> localhost]: Wait for the OS image installation of server 'CZ2311004G' to complete (45 retries left).
FAILED - RETRYING: [ESX-1 -> localhost]: Wait for the OS image installation of server 'CZ2311004H' to complete (44 retries left).
FAILED - RETRYING: [ESX-2 -> localhost]: Wait for the OS image installation of server 'CZ2311004G' to complete (44 retries left).
FAILED - RETRYING: [ESX-2 -> localhost]: Wait for the OS image installation of server 'CZ2311004G' to complete (43 retries left).
FAILED - RETRYING: [ESX-1 -> localhost]: Wait for the OS image installation of server 'CZ2311004H' to complete (43 retries left).
FAILED - RETRYING: [ESX-2 -> localhost]: Wait for the OS image installation of server 'CZ2311004G' to complete (42 retries left).
FAILED - RETRYING: [ESX-1 -> localhost]: Wait for the OS image installation of server 'CZ2311004H' to complete (42 retries left).
FAILED - RETRYING: [ESX-1 -> localhost]: Wait for the OS image installation of server 'CZ2311004H' to complete (41 retries left).
FAILED - RETRYING: [ESX-2 -> localhost]: Wait for the OS image installation of server 'CZ2311004G' to complete (41 retries left).
FAILED - RETRYING: [ESX-1 -> localhost]: Wait for the OS image installation of server 'CZ2311004H' to complete (40 retries left).
FAILED - RETRYING: [ESX-2 -> localhost]: Wait for the OS image installation of server 'CZ2311004G' to complete (40 retries left).
FAILED - RETRYING: [ESX-1 -> localhost]: Wait for the OS image installation of server 'CZ2311004H' to complete (39 retries left).
FAILED - RETRYING: [ESX-2 -> localhost]: Wait for the OS image installation of server 'CZ2311004G' to complete (39 retries left).
ok: [ESX-1 -> localhost]
ok: [ESX-2 -> localhost]

TASK [Exit if operating system image installation task of server 'CZ2311004H' failed to complete] *************************************************************************************************************************************************************************************************************************************************
skipping: [ESX-1]
skipping: [ESX-2]

TASK [Unassign server 'CZ2311004H' from temporary group 'ESX-1_server_group'] *********************************************************************************************************************************************************************************************************************************************************************
ok: [ESX-1 -> localhost]
ok: [ESX-2 -> localhost]

TASK [Wait for deletion to complete] **************************************************************************************************************************************************************************************************************************************************************************************************************
Pausing for 15 seconds
(ctrl+C then 'C' = continue early, ctrl+C then 'A' = abort)
ok: [ESX-1]

TASK [Display response of the temporary group unassignment task] **********************************************************************************************************************************************************************************************************************************************************************************
ok: [ESX-1] => {
    "group_unassignment_result.msg": "OK (0 bytes)"
}
ok: [ESX-2] => {
    "group_unassignment_result.msg": "OK (0 bytes)"
}

TASK [Delete temporary group 'ESX-1_server_group'] ************************************************************************************************************************************************************************************************************************************************************************************************
ok: [ESX-1 -> localhost]
ok: [ESX-2 -> localhost]

TASK [Display response of the temporary group deletion task] **************************************************************************************************************************************************************************************************************************************************************************************
ok: [ESX-1] => {
    "server_group_deletion_result.msg": "OK (0 bytes)"
}
ok: [ESX-2] => {
    "server_group_deletion_result.msg": "OK (0 bytes)"
}

TASK [Delete operating system image server setting 'OS_Image_ESXi7.0.u3_for_ESX-1'] ***************************************************************************************************************************************************************************************************************************************************************
ok: [ESX-1 -> localhost]
ok: [ESX-2 -> localhost]

TASK [Display response of the operating system image server setting deletion task] ****************************************************************************************************************************************************************************************************************************************************************
ok: [ESX-1] => {
    "OS_image_server_setting_deletion_result.msg": "OK (0 bytes)"
}
ok: [ESX-2] => {
    "OS_image_server_setting_deletion_result.msg": "OK (0 bytes)"
}

TASK [Wait for '192.168.3.174' to respond on port 80...] ******************************************************************************************************************************************************************************************************************************************************************************************
ok: [ESX-1 -> localhost]
ok: [ESX-2 -> localhost]

TASK [Wait a little longer so that the ESX host is truly ready to be added to vCenter] ************************************************************************************************************************************************************************************************************************************************************
ok: [ESX-1 -> localhost]
ok: [ESX-2 -> localhost]

TASK [Create a kickstart backup directory if it does not exist] ***********************************************************************************************************************************************************************************************************************************************************************************
ok: [ESX-1 -> localhost]
ok: [ESX-2 -> localhost]

TASK [Create a backup of the kickstart file named 'ESX-1_ks.cfg' in '/home/labrat/staging/kickstarts_backup/ESXi' folder] *************************************************************************************************************************************************************************************************************************
changed: [ESX-1 -> localhost]
changed: [ESX-2 -> localhost]

TASK [Delete all related files from staging location and nginx web server folder] *****************************************************************************************************************************************************************************************************************************************************************
changed: [ESX-1 -> localhost]
changed: [ESX-2 -> localhost]

TASK [Set fact for the first host in inventory] ***************************************************************************************************************************************************************************************************************************************************************************************************
ok: [ESX-1]
ok: [ESX-2]

TASK [Check if ESXi cluster 'DL-Cluster-01' exists in vCenter 'vcenter.lj.lab'] *******************************************************************************************************************************************************************************************************************************************************************
skipping: [ESX-2]
ok: [ESX-1 -> localhost]

TASK [Create ESXi cluster 'DL-Cluster-01' in vCenter 'vcenter.lj.lab' if not present] *************************************************************************************************************************************************************************************************************************************************************
skipping: [ESX-1]
skipping: [ESX-2]

TASK [Pause for 10 seconds for the cluster to be ready] *******************************************************************************************************************************************************************************************************************************************************************************************
skipping: [ESX-1]

TASK [Enable HA without admission control on 'DL-Cluster-01' cluster] *****************************************************************************************************************************************************************************************************************************************************************************
skipping: [ESX-2]
ok: [ESX-1 -> localhost]

TASK [Enable DRS with VM distribution across hosts for availability on 'DL-Cluster-01' cluster] ***************************************************************************************************************************************************************************************************************************************************
skipping: [ESX-2]
ok: [ESX-1 -> localhost]

TASK [Pause for 10 seconds for the cluster to be ready] *******************************************************************************************************************************************************************************************************************************************************************************************
skipping: [ESX-1]

TASK [Add ESXi host 'esx-1.lj.lab' to 'DL-Cluster-01' cluster] ************************************************************************************************************************************************************************************************************************************************************************************
changed: [ESX-1 -> localhost]
changed: [ESX-2 -> localhost]

TASK [Assign ESXi license to Host] ****************************************************************************************************************************************************************************************************************************************************************************************************************
changed: [ESX-1 -> localhost]
changed: [ESX-2 -> localhost]

TASK [Add vmnic1 to standard switch vSwitch0] *****************************************************************************************************************************************************************************************************************************************************************************************************
changed: [ESX-1 -> localhost]
changed: [ESX-2 -> localhost]

TASK [Pause for 10 seconds to give time for the vswitch0 configuration] ***************************************************************************************************************************************************************************************************************************************************************************
Pausing for 10 seconds
(ctrl+C then 'C' = continue early, ctrl+C then 'A' = abort)
ok: [ESX-1]

TASK [Add vMotion Portgroup to standard switch vSwitch0] ******************************************************************************************************************************************************************************************************************************************************************************************
changed: [ESX-2 -> localhost]
changed: [ESX-1 -> localhost]

TASK [Pause for 10 seconds to give time for the vswitch0 configuration] ***************************************************************************************************************************************************************************************************************************************************************************
Pausing for 10 seconds
(ctrl+C then 'C' = continue early, ctrl+C then 'A' = abort)
ok: [ESX-1]

TASK [Re-add ESXi host 'esx-1.lj.lab' to 'DL-Cluster-01' cluster (sometimes the host disconnects for an unknown reason)] **************************************************************************************************************************************************************************************************************************
ok: [ESX-1 -> localhost]
ok: [ESX-2 -> localhost]

TASK [Pause for 10 seconds to give time for the vswitch0 configuration] ***************************************************************************************************************************************************************************************************************************************************************************
Pausing for 10 seconds
(ctrl+C then 'C' = continue early, ctrl+C then 'A' = abort)
ok: [ESX-1]

TASK [Change Advanced Settings with Core Dump Warning Disable] ************************************************************************************************************************************************************************************************************************************************************************************
changed: [ESX-2 -> localhost]
changed: [ESX-1 -> localhost]

TASK [Set the Power Management Policy to high-performance] ****************************************************************************************************************************************************************************************************************************************************************************************
changed: [ESX-2 -> localhost]
changed: [ESX-1 -> localhost]

TASK [Configure NTP servers] **********************************************************************************************************************************************************************************************************************************************************************************************************************
changed: [ESX-1 -> localhost]
changed: [ESX-2 -> localhost]

TASK [Start NTP Service and set to start at boot] *************************************************************************************************************************************************************************************************************************************************************************************************
changed: [ESX-2 -> localhost]
changed: [ESX-1 -> localhost]

TASK [Start ESXi Shell Service and setting to enable at boot] *************************************************************************************************************************************************************************************************************************************************************************************
changed: [ESX-1 -> localhost]
changed: [ESX-2 -> localhost]

TASK [Start SSH Service and setting to enable at boot] ********************************************************************************************************************************************************************************************************************************************************************************************
changed: [ESX-1 -> localhost]
changed: [ESX-2 -> localhost]

TASK [Collect firmware bundles] *******************************************************************************************************************************************************************************************************************************************************************************************************************
skipping: [ESX-2]
ok: [ESX-1 -> localhost]

TASK [Set variable for Gen10 firmware bundle '2023.09.00.00'] *************************************************************************************************************************************************************************************************************************************************************************************
ok: [ESX-1]
skipping: [ESX-2]

TASK [Exit if Gen10 firmware bundle '2023.09.00.00' does not exist] *******************************************************************************************************************************************************************************************************************************************************************************
skipping: [ESX-1]
skipping: [ESX-2]

TASK [debug] **************************************************************************************************************************************************************************************************************************************************************************************************************************************
ok: [ESX-1] => {
    "Gen10_10p_firmware_bundle_ID": "275a59f78916400a761e4bf8c6958934"
}
skipping: [ESX-2]

TASK [Set variable for '2023.09.00.01' associated patch for Gen10 firmware bundle '2023.09.00.00'] ************************************************************************************************************************************************************************************************************************************************
ok: [ESX-1]
skipping: [ESX-2]

TASK [Exit if Gen10 associated patch '2023.09.00.01' does not exist] ******************************************************************************************************************************************************************************************************************************************************************************
skipping: [ESX-1]
skipping: [ESX-2]

TASK [debug] **************************************************************************************************************************************************************************************************************************************************************************************************************************************
ok: [ESX-1] => {
    "Gen10_10p_patch_firmware_ID": "e3cfbf02d95c27e4aa5a4f824c032053"
}
skipping: [ESX-2]

TASK [Set variable for Gen11 firmware bundle '2023.10.00.00'] *************************************************************************************************************************************************************************************************************************************************************************************
ok: [ESX-1]
skipping: [ESX-2]

TASK [Exit if Gen11 firmware bundle '2023.10.00.00' does not exist] *******************************************************************************************************************************************************************************************************************************************************************************
skipping: [ESX-1]
skipping: [ESX-2]

TASK [debug] **************************************************************************************************************************************************************************************************************************************************************************************************************************************
ok: [ESX-1] => {
    "Gen11_firmware_bundle_ID": "18aff817eb9c4bb256eeaf09743b3273"
}
skipping: [ESX-2]

TASK [debug] **************************************************************************************************************************************************************************************************************************************************************************************************************************************
skipping: [ESX-1]
skipping: [ESX-2]

TASK [Set variable for '' associated patch for Gen11 firmware bundle '2023.10.00.00'] *************************************************************************************************************************************************************************************************************************************************************
skipping: [ESX-1]
skipping: [ESX-2]

TASK [Exit if Gen11 associated patch '' does not exist] *******************************************************************************************************************************************************************************************************************************************************************************************
skipping: [ESX-1]
skipping: [ESX-2]

TASK [debug] **************************************************************************************************************************************************************************************************************************************************************************************************************************************
skipping: [ESX-1]
skipping: [ESX-2]

TASK [Set the final variable value for the Gen10 firmware bundle ID] ******************************************************************************************************************************************************************************************************************************************************************************
ok: [ESX-1]
skipping: [ESX-2]

TASK [Set the final variable value for the Gen11 firmware bundle ID] ******************************************************************************************************************************************************************************************************************************************************************************
skipping: [ESX-1]
skipping: [ESX-2]

TASK [Fail if the firmware baselines for Gen10/Gen10+ and Gen11 servers could not be found.] ******************************************************************************************************************************************************************************************************************************************************
skipping: [ESX-1]
skipping: [ESX-2]

TASK [Fail if the firmware baseline for Gen10/Gen10+ servers could not be found.] *****************************************************************************************************************************************************************************************************************************************************************
skipping: [ESX-1]
skipping: [ESX-2]

TASK [Fail if the firmware baseline for Gen11 servers could not be found.] ************************************************************************************************************************************************************************************************************************************************************************
skipping: [ESX-1]
skipping: [ESX-2]

TASK [Set firmware bundle id for Gen10/Gen10+ server] *********************************************************************************************************************************************************************************************************************************************************************************************
ok: [ESX-1]
skipping: [ESX-2]

TASK [Set firmware bundle id for Gen11 server] ****************************************************************************************************************************************************************************************************************************************************************************************************
skipping: [ESX-1]
skipping: [ESX-2]

TASK [debug] **************************************************************************************************************************************************************************************************************************************************************************************************************************************
ok: [ESX-1] => {
    "bundle_id": "e3cfbf02d95c27e4aa5a4f824c032053"
}
skipping: [ESX-2]

TASK [Check if the firmware server setting 'ESXi firmware baseline' exists] ***********************************************************************************************************************************************************************************************************************************************************************
skipping: [ESX-2]
ok: [ESX-1 -> localhost]

TASK [Create the firmware server setting 'ESXi firmware baseline'] ********************************************************************************************************************************************************************************************************************************************************************************
skipping: [ESX-1]
skipping: [ESX-2]

TASK [Display response of the firmware server setting 'ESXi firmware baseline' creation request] **************************************************************************************************************************************************************************************************************************************************
skipping: [ESX-1]
skipping: [ESX-2]

TASK [Set variable for the resourceuri of the firmware server setting 'ESXi firmware baseline' just created] **************************************************************************************************************************************************************************************************************************************
skipping: [ESX-1]
skipping: [ESX-2]

TASK [Update the firmware server setting 'ESXi firmware baseline'] ********************************************************************************************************************************************************************************************************************************************************************************
skipping: [ESX-2]
ok: [ESX-1 -> localhost]

TASK [Display response of the firmware server setting 'ESXi firmware baseline' update task] *******************************************************************************************************************************************************************************************************************************************************
ok: [ESX-1] => {
    "firmware_server_setting_result.msg": "OK (521 bytes)"
}
skipping: [ESX-2]

TASK [Set variable for the resourceuri of the firmware server setting 'ESXi firmware baseline' just updated] **************************************************************************************************************************************************************************************************************************************
skipping: [ESX-2]
ok: [ESX-1]

TASK [debug] **************************************************************************************************************************************************************************************************************************************************************************************************************************************
ok: [ESX-1] => {
    "firmware_server_setting_resourceuri": "/compute-ops/v1beta1/server-settings/187b2f5d-1d07-4f1b-9fd9-a72aeb9aa5b3"
}
skipping: [ESX-2]

TASK [Check if definitive group 'ESXi_group' already exist] ***************************************************************************************************************************************************************************************************************************************************************************************
skipping: [ESX-2]
ok: [ESX-1 -> localhost]

TASK [Create definitive group 'ESXi_group' if it does not exist] **********************************************************************************************************************************************************************************************************************************************************************************
skipping: [ESX-1]
skipping: [ESX-2]

TASK [Display response of the definitive group 'ESXi_group' creation request] *********************************************************************************************************************************************************************************************************************************************************************
skipping: [ESX-1]
skipping: [ESX-2]

TASK [Set variables for the id and the resourceUri of the definitive group 'ESXi_group' just created] *********************************************************************************************************************************************************************************************************************************************
skipping: [ESX-1]
skipping: [ESX-2]

TASK [Update definitive group 'ESXi_group' if it does exist] **************************************************************************************************************************************************************************************************************************************************************************************
skipping: [ESX-2]
ok: [ESX-1 -> localhost]

TASK [Display response of the group 'ESXi_group' update request] **********************************************************************************************************************************************************************************************************************************************************************************
ok: [ESX-1] => {
    "definitive_server_group_result.msg": "OK (1073 bytes)"
}
skipping: [ESX-2]

TASK [Set variables for the id and the resourceUri of the existing definitive group 'ESXi_group' just updated] ************************************************************************************************************************************************************************************************************************************
skipping: [ESX-2]
ok: [ESX-1]

TASK [debug] **************************************************************************************************************************************************************************************************************************************************************************************************************************************
ok: [ESX-1] => {
    "definitive_group_id": "219da92b-507a-4433-8d80-dfa057a93b7d"
}
skipping: [ESX-2]

TASK [debug] **************************************************************************************************************************************************************************************************************************************************************************************************************************************
ok: [ESX-1] => {
    "definitive_group_resourceuri": "/compute-ops/v1beta2/groups/219da92b-507a-4433-8d80-dfa057a93b7d"
}
skipping: [ESX-2]

TASK [Place ESXi host 'esx-1.lj.lab' into maintenance mode] ***************************************************************************************************************************************************************************************************************************************************************************************
changed: [ESX-1 -> localhost]
changed: [ESX-2 -> localhost]

TASK [Gather subset facts on localhost] ***********************************************************************************************************************************************************************************************************************************************************************************************************
ok: [ESX-1 -> localhost]
ok: [ESX-2 -> localhost]

TASK [Capture the start time of the firmware update (will be used later to filter COM activities, etc.)] ******************************************************************************************************************************************************************************************************************************************
ok: [ESX-1]
ok: [ESX-2]

TASK [Display the start time of the firmware update] **********************************************************************************************************************************************************************************************************************************************************************************************
ok: [ESX-1] => {
    "msg": "2024-01-24T16:17:56Z"
}
ok: [ESX-2] => {
    "msg": "2024-01-24T16:17:56Z"
}

TASK [Get definitive group 'ESXi_group' information] **********************************************************************************************************************************************************************************************************************************************************************************************
ok: [ESX-1 -> localhost]
ok: [ESX-2 -> localhost]

TASK [Set variable for existing definitive group 'ESXi_group' id] *********************************************************************************************************************************************************************************************************************************************************************************
ok: [ESX-1]
ok: [ESX-2]

TASK [Check if server 'CZ2311004H' is already member of definitive server group 'ESXi_group'] *****************************************************************************************************************************************************************************************************************************************************
ok: [ESX-1]
ok: [ESX-2]

TASK [Assign server 'CZ2311004H' to definitive server group 'ESXi_group'] *************************************************************************************************************************************************************************************************************************************************************************
ok: [ESX-1 -> localhost]
ok: [ESX-2 -> localhost]

TASK [Display response of the group assignment task] **********************************************************************************************************************************************************************************************************************************************************************************************
ok: [ESX-1] => {
    "group_assignment_result.msg": "OK (518 bytes)"
}
ok: [ESX-2] => {
    "group_assignment_result.msg": "OK (518 bytes)"
}

TASK [Wait for assignment to truly complete] ******************************************************************************************************************************************************************************************************************************************************************************************************
Pausing for 15 seconds
(ctrl+C then 'C' = continue early, ctrl+C then 'A' = abort)
ok: [ESX-1]

TASK [Get definitive group 'ESXi_group' information (first host only)] ****************************************************************************************************************************************************************************************************************************************************************************
skipping: [ESX-2]
ok: [ESX-1 -> localhost]

TASK [Set fact for the list of server IDs member of the definitive server group (first host only)] ************************************************************************************************************************************************************************************************************************************************
ok: [ESX-1]
skipping: [ESX-2]

TASK [Display the server IDs found (first host only)] *********************************************************************************************************************************************************************************************************************************************************************************************
ok: [ESX-1] => {
    "server_ids": [
        "P28948-B21+CZ2311004G",
        "P28948-B21+CZ2311004H"
    ]
}
skipping: [ESX-2]

TASK [Create HPE Compute Ops Management session] **************************************************************************************************************************************************************************************************************************************************************************************************
ok: [ESX-2 -> localhost]
ok: [ESX-1 -> localhost]

TASK [Set variable access_token for the bearer token] *********************************************************************************************************************************************************************************************************************************************************************************************
ok: [ESX-1]
ok: [ESX-2]

TASK [Start a group firmware update job using the defined firmware baseline (first host only)] ****************************************************************************************************************************************************************************************************************************************************
skipping: [ESX-2]
ok: [ESX-1 -> localhost]

TASK [Display response of the group firmware update job (first host only)] ************************************************************************************************************************************************************************************************************************************************************************
ok: [ESX-1] => {
    "group_firmware_update_job.msg": "OK (1126 bytes)"
}
skipping: [ESX-2]

TASK [Capture the resourceUri of the group firmware update job (first host only)] *****************************************************************************************************************************************************************************************************************************************************************
ok: [ESX-1]
skipping: [ESX-2]

TASK [Display the group firmware update job resource uri (first host only)] ***********************************************************************************************************************************************************************************************************************************************************************
ok: [ESX-1] => {
    "group_firmware_update_job_resourceUri": "/compute-ops/v1beta3/jobs/4614852d-f0dc-4179-a4c6-25101d6fe844"
}
skipping: [ESX-2]

TASK [Wait for the group firmware update job to complete (first host only)] ***********************************************************************************************************************************************************************************************************************************************************************
skipping: [ESX-2]
FAILED - RETRYING: [ESX-1 -> localhost]: Wait for the group firmware update job to complete (first host only) (600 retries left).
FAILED - RETRYING: [ESX-1 -> localhost]: Wait for the group firmware update job to complete (first host only) (599 retries left).
FAILED - RETRYING: [ESX-1 -> localhost]: Wait for the group firmware update job to complete (first host only) (598 retries left).
FAILED - RETRYING: [ESX-1 -> localhost]: Wait for the group firmware update job to complete (first host only) (597 retries left).
ok: [ESX-1 -> localhost]

TASK [Display the group firmware update job result (first host only)] *****************************************************************************************************************************************************************************************************************************************************************************
ok: [ESX-1] => {
    "msg": [
        "State: COMPLETE",
        "ResultCode: SUCCESS",
        "Status: Complete"
    ]
}
skipping: [ESX-2]

TASK [Get the latest activity of server 'CZ2311004H'] *********************************************************************************************************************************************************************************************************************************************************************************************
ok: [ESX-1 -> localhost]
ok: [ESX-2 -> localhost]

TASK [Extract items containing 'Firmware update'] *************************************************************************************************************************************************************************************************************************************************************************************************
ok: [ESX-1]
ok: [ESX-2]

TASK [Display the firmware update activity status when successful] ********************************************************************************************************************************************************************************************************************************************************************************
ok: [ESX-1] => {
    "msg": [
        "Message: Firmware update successful",
        "",
        "**Note:** The server firmware is already up to date with specified baseline Patch 2023.09.00.01 + SPP 2023.09.00.00 (03 Nov 2023). The specified baseline has been set for the server.",
        ""
    ]
}
ok: [ESX-2] => {
    "msg": [
        "Message: Firmware update successful",
        "",
        "**Note:** The server firmware is already up to date with specified baseline Patch 2023.09.00.01 + SPP 2023.09.00.00 (03 Nov 2023). The specified baseline has been set for the server.",
        ""
    ]
}

TASK [Display the firmware update activity status with recommanded actions when failed] ***********************************************************************************************************************************************************************************************************************************************************
skipping: [ESX-1]
skipping: [ESX-2]

TASK [Capture server information] *****************************************************************************************************************************************************************************************************************************************************************************************************************
ok: [ESX-1 -> localhost]
ok: [ESX-2 -> localhost]

TASK [Capture last firmware update information] ***************************************************************************************************************************************************************************************************************************************************************************************************
ok: [ESX-1]
ok: [ESX-2]

TASK [Display server last firmware update information if up-to-date] ******************************************************************************************************************************************************************************************************************************************************************************
skipping: [ESX-1]
skipping: [ESX-2]

TASK [Wait until VMware host is 'connected' in vCenter] *******************************************************************************************************************************************************************************************************************************************************************************************
ok: [ESX-2 -> localhost]
ok: [ESX-1 -> localhost]

TASK [Take ESXi host 'esx-1.lj.lab' out of maintenance mode] **************************************************************************************************************************************************************************************************************************************************************************************
changed: [ESX-2 -> localhost]
changed: [ESX-1 -> localhost]

TASK [Force update of current timestamp] **********************************************************************************************************************************************************************************************************************************************************************************************************
ok: [ESX-1 -> localhost]
ok: [ESX-2 -> localhost]

TASK [Get runtime] ********************************************************************************************************************************************************************************************************************************************************************************************************************************
ok: [ESX-1]
ok: [ESX-2]

TASK [Status of the OS installation with the firmware update with HPE drivers and software] *******************************************************************************************************************************************************************************************************************************************************
skipping: [ESX-1]
skipping: [ESX-2]

TASK [Status of the OS installation with the firmware update without HPE drivers and software] ****************************************************************************************************************************************************************************************************************************************************
ok: [ESX-1] => {
    "msg": [
        "ESX-1.lj.lab installation and firmware update completed successfully!",
        "OS is configured and running and added to the vCenter cluster 'DL-Cluster-01'",
        "To SSH to the new host from Ansible control node, use: ssh root@ESX-1.lj.lab",
        "The provisioning task took 0:40:24."
    ]
}
ok: [ESX-2] => {
    "msg": [
        "ESX-2.lj.lab installation and firmware update completed successfully!",
        "OS is configured and running and added to the vCenter cluster 'DL-Cluster-01'",
        "To SSH to the new host from Ansible control node, use: ssh root@ESX-2.lj.lab",
        "The provisioning task took 0:40:23."
    ]
}

TASK [Status of the OS installation with firmware update failure] *********************************************************************************************************************************************************************************************************************************************************************************
skipping: [ESX-1]
skipping: [ESX-2]

PLAY RECAP ****************************************************************************************************************************************************************************************************************************************************************************************************************************************
ESX-1                      : ok=146  changed=26   unreachable=0    failed=0    skipped=69   rescued=0    ignored=0   
ESX-2                      : ok=117  changed=26   unreachable=0    failed=0    skipped=90   rescued=0    ignored=0   